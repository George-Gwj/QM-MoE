# IsaacGym障碍物系统测试指南

本文档说明如何使用测试脚本来验证IsaacGym环境中的障碍物是否正常添加和运动。

## 测试脚本说明

### 1. `simple_obstacle_test.py` - 简化版测试脚本
- **用途**: 基础功能测试，不依赖完整的IsaacGym环境
- **特点**: 快速验证，减少依赖问题
- **适用场景**: 初步验证障碍物系统的基础功能

### 2. `test_obstacles.py` - 完整版测试脚本
- **用途**: 完整功能测试，包括可视化验证
- **特点**: 全面测试，包含GUI验证
- **适用场景**: 完整验证障碍物系统的所有功能

## 使用方法

### 运行简化版测试
```bash
cd umi-on-legs/mani-centric-wbc/legged_gym/env/isaacgym/
python simple_obstacle_test.py
```

### 运行完整版测试
```bash
cd umi-on-legs/mani-centric-wbc/legged_gym/env/isaacgym/
python test_obstacles.py
```

## 测试内容

### 1. 障碍物管理器测试
- 检查`ObstacleManager`类是否正确导入
- 验证类的方法和属性
- 确认障碍物创建逻辑

### 2. 障碍物参数测试
- 验证障碍物数量（2球体 + 6胶囊体 + 1矩形）
- 检查障碍物位置参数
- 确认障碍物尺寸和颜色设置

### 3. 障碍物创建逻辑测试
- 验证张量数据结构
- 检查障碍物信息组织
- 确认多环境支持

### 4. 障碍物运动模拟测试
- 验证运动更新逻辑
- 检查位置变化计算
- 确认时间步长处理

### 5. CBF集成测试
- 检查CBF相关属性
- 验证障碍物信息传递
- 确认系统集成状态

### 6. 可视化测试（仅完整版）
- 启动IsaacGym GUI
- 显示障碍物3D模型
- 验证障碍物运动动画

## 期望结果

### 成功标志
- 所有测试显示"✓ 通过"
- 障碍物数量正确（总共9个）
- 障碍物位置参数正确
- 张量形状符合预期
- 运动模拟正常工作

### 可能的问题
1. **导入错误**: 检查Python路径和依赖
2. **CUDA问题**: 确认GPU驱动和CUDA版本
3. **IsaacGym问题**: 验证IsaacGym安装
4. **URDF文件**: 确认机器人模型文件存在

## 障碍物详细信息

### 球体障碍物 (2个)
- **ball**: 位置[1.00, 0.0, 2.8], 半径0.2, 红色
- **ball1**: 位置[0.35, 0.5, 2.75], 半径0.1, 红色

### 胶囊体障碍物 (6个)
- **capsule**: 位置[-0.05, 2.5, 0.68], 尺寸[0.05, 0.3], 绿色
- **capsule1**: 位置[-0.0, -1.7, 0.45], 尺寸[0.1, 0.1], 绿色
- **capsule2**: 位置[-0.7, 1.7, 0.35], 尺寸[0.05, 0.28], 绿色
- **capsule3**: 位置[-0.7, 1.2, 0.35], 尺寸[0.05, 0.28], 绿色
- **capsule4**: 位置[0.7, 1.7, 0.35], 尺寸[0.05, 0.28], 绿色
- **capsule5**: 位置[0.7, 1.2, 0.35], 尺寸[0.05, 0.28], 绿色

### 矩形障碍物 (1个)
- **rectangle**: 位置[-0.05, 1.45, 1.8], 尺寸[0.45, 0.3, 0.05], 蓝色

## 运动模式

所有障碍物都支持动态运动：
- **球体**: 主要在Z轴方向运动
- **胶囊体**: 主要在X轴和Z轴方向运动
- **矩形**: 主要在Z轴方向运动

运动使用正弦函数模拟，频率和幅度可调。

## 故障排除

### 常见问题
1. **模块导入失败**: 检查Python路径和项目结构
2. **CUDA错误**: 确认GPU驱动和IsaacGym版本兼容
3. **URDF文件缺失**: 确认机器人模型文件路径正确
4. **权限问题**: 确认有足够的权限运行IsaacGym

### 调试建议
1. 先运行简化版测试，确认基础功能
2. 检查错误日志和异常信息
3. 验证IsaacGym环境配置
4. 确认所有依赖包已正确安装

## 联系支持

如果遇到问题，请：
1. 检查错误日志
2. 确认系统环境
3. 提供详细的错误信息
4. 说明使用的测试脚本和步骤 